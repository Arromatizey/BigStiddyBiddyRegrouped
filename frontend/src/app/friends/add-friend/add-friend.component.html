<div class="add-friend">
  <div class="add-friend-header">
    <h2>➕ Ajouter un ami</h2>
    <p>Recherchez des utilisateurs par nom ou email</p>
  </div>

  <!-- Search Input -->
  <div class="search-section">
    <div class="search-input-container">
      <input
        type="text"
        class="search-input"
        placeholder="Rechercher par nom ou email..."
        [(ngModel)]="searchQuery"
        (ngModelChange)="onSearchInputChange($event)"
        autocomplete="off">
      
      <button 
        *ngIf="searchQuery" 
        class="clear-search-btn" 
        (click)="clearSearch()"
        title="Effacer la recherche">
        ❌
      </button>
    </div>

    <!-- Search Status -->
    <div class="search-status">
      <div *ngIf="searching" class="searching">
        <div class="mini-spinner"></div>
        <span>Recherche en cours...</span>
      </div>
      
      <div *ngIf="searchError" class="search-error">
        {{ searchError }}
      </div>
      
      <div *ngIf="!searching && searchQuery && searchResults.length === 0 && !searchError" class="no-results">
        Aucun utilisateur trouvé pour "{{ searchQuery }}"
      </div>
    </div>
  </div>

  <!-- Search Results -->
  <div *ngIf="searchResults.length > 0" class="search-results">
    <h3>📋 Résultats de recherche ({{ searchResults.length }})</h3>
    
    <div class="results-list">
      <div 
        *ngFor="let user of searchResults; trackBy: trackByUserId" 
        class="user-card">
        
        <!-- Avatar -->
        <div class="user-avatar">
          <img 
            *ngIf="user.avatarUrl" 
            [src]="user.avatarUrl" 
            [alt]="user.displayName || user.email"
            class="avatar-img">
          <div 
            *ngIf="!user.avatarUrl" 
            class="avatar-placeholder">
            {{ getUserInitials(user.displayName, user.email) }}
          </div>
        </div>

        <!-- User Info -->
        <div class="user-info">
          <h4 class="user-name">{{ user.displayName || user.email }}</h4>
          <p class="user-email" *ngIf="user.displayName">{{ user.email }}</p>
          <div class="user-status">
            <span class="status-indicator" [class.verified]="user.verified">
              {{ user.verified ? '✅ Vérifié' : '⏳ Non vérifié' }}
            </span>
          </div>
        </div>

        <!-- Actions -->
        <div class="user-actions">
          <button 
            *ngIf="!hasRequestSent(user.id)"
            class="add-friend-btn" 
            (click)="sendFriendRequest(user)"
            [disabled]="isSendingRequest(user.id)"
            title="Envoyer une demande d'amitié">
            <span *ngIf="!isSendingRequest(user.id)">🤝 Ajouter</span>
            <span *ngIf="isSendingRequest(user.id)" class="mini-spinner"></span>
          </button>

          <div *ngIf="hasRequestSent(user.id)" class="request-sent">
            <span class="sent-badge">✅ Demande envoyée</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tips Section -->
  <div *ngIf="!searchQuery" class="tips-section">
    <div class="tips-card">
      <h3>💡 Conseils pour trouver des amis</h3>
      <ul class="tips-list">
        <li>Recherchez par nom d'utilisateur ou email</li>
        <li>Utilisez au moins 2 caractères pour la recherche</li>
        <li>Les utilisateurs vérifiés apparaissent avec une coche verte</li>
        <li>Vous pouvez voir vos demandes envoyées dans l'onglet "Demandes"</li>
      </ul>
    </div>
  </div>
</div> 